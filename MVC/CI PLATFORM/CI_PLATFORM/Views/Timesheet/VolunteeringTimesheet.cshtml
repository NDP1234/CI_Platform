@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    Layout = null;
}
@using CI_Platform.Entities.Models.VM
@inject CI_Platform.Entities.Data.CiPlatformContext _db

@model VTSViewModel;

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volunterring Timesheet</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.4/font/bootstrap-icons.css">
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css">

    

    <link rel="stylesheet" href="~/css/vts.css">

</head>

<body>
    <div class="container-fliud">
        <nav class="navbar navbar-expand-lg navbar-light d-none d-md-block">
            <div class="container">
                <button class="navbar-toggler bg-light " type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0 mrg-start">

                        <li class="nav-item ">
                            <a class="nav-link text-dark" asp-action="Story_Listing_Page"
                               asp-controller="StoryRelated">Stories</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" href="#" role="button"
                               data-bs-toggle="dropdown" aria-expanded="false">
                                Policy
                            </a>
                            <ul class="dropdown-menu text-center">
                                <li class="mx-auto"><a asp-action="PrivacyPolicyPage" asp-controller="UserEditProfile" class="text-decoration-none text-dark"> Privacy Policy</a></li>
                                
                            </ul>
                        </li>

                    </ul>
                    <form class="d-flex" role="search">

                        <div class="dropdown">
                            <a class="btn  dropdown-toggle p-0" href="#" role="button" id="dropdownMenuLink"
                               data-bs-toggle="dropdown" aria-expanded="false">
                                <img src="@ViewBag.UserDetails.Avatar" alt="" style="border-radius: 50%;" height="30px"
                                     width="30px">
                                <span>@ViewBag.UserDetails.FirstName @ViewBag.UserDetails.LastName</span>
                            </a>

                            <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                @if(@ViewBag.UserDetails.Role == "admin")
                                {
                                    <li><a class="dropdown-item" asp-action="AdminDashBoard" asp-controller="Admin">Dashboard</a></li>
                                }
                                <li><a class="dropdown-item" asp-action="UserEditProfilePage" asp-controller="UserEditProfile">My Account</a></li>
                                <li><a class="dropdown-item" asp-action="VolunteeringTimesheet" asp-controller="Timesheet">Volunteering Timesheet</a></li>
                                <li><a class="dropdown-item" asp-action="Logout" asp-controller="Authentication">Logout </a></li>
                            </ul>
                        </div>
                    </form>
                </div>
            </div>
        </nav>

        <!-- ////////////////////////////////// -->
        <div class="first-nav d-md-none ">
            <div id="mySidebar1" class="sidebar d-inline">
                <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
                <a href="#">
                    Stories
                </a>

                <a href="#">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle " href="#" role="button" data-bs-toggle="dropdown"
                           aria-expanded="false">
                            Policy
                        </a>
                        <ul class="dropdown-menu ">
                            <li><a class="dropdown-item " href="#">Policy-1</a></li>
                            <li><a class="dropdown-item" href="#">Policy-2</a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="#">Something else </a></li>
                        </ul>
                    </li>
                </a>
            </div>
            <div id="main1" class="d-flex justify-content-between m-2">
                <button class="openbtn " onclick="openNav()">☰ </button>
                <img src="/Images/volunteer1.png" class="rounded-pill  " height="40px" width="40px" alt="">
            </div>
        </div>
        <!-- //////////////////////////////// -->

        <hr class="hr" />
    </div>
    <div class="container">
        <h3>Volunteering Timesheet</h3>
        <div class="row mt-5">
            <div class="col-md-6">
                <div class="timebasedmission border">
                    <div class="px-3">
                        <div class="row">
                            <div class="col-md-10 my-3">
                                <h5 class=" d-inline">Volunteering Hours</h5>
                            </div>
                            <div class="col-md-2 my-3">
                                <div class="justify-content-end">
                                    <button class="ms-3 bg-white border-0" type="button"
                                            data-bs-toggle="modal" data-bs-target="#TimeBasedModal">
                                        <img src="/images/add.png" alt="">
                                    </button>
                                </div>
                            </div>
                        </div>



                        <table class="table  table-borderless">
                            <thead>
                                <tr>
                                    <th scope="col">Mission</th>
                                    <th scope="col">Date</th>
                                    <th scope="col">Hours</th>
                                    <th scope="col">Minutes</th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.timesheets)
                                {
                                    <tr>
                                        <td class="Titlewidth">@item.Mission.Title</td>
                                        <td>@item.DateVolunteered</td>
                                        <td>@item.Time.Value.Hour</td>
                                        <td>@item.Time.Value.Minute</td>
                                        <td>
                                            <button class="d-inline border-0 bg-white" type="button" id="editableBtn" data-bs-toggle="modal" data-timesheet-id="@item.TimesheetId" data-bs-target="#editTimeBasedModal-@item.TimesheetId"><i class="bi bi-pencil-square"></i></button>
                                            <button class="d-inline border-0 bg-white TrashBtn" type="button" id="TrashBtn" data-timesheet-id="@item.TimesheetId"><i class="bi bi-trash"></i></button>

                                        </td>
                                        <div class="modal fade" id="editTimeBasedModal-@item.TimesheetId" tabindex="-1" aria-labelledby="exampleModalLabel"
                                         aria-hidden="true">

                                            <div class="modal-dialog modal-lg">
                                                <form class="row g-3 needs-validation editabletimebasedtimesheet " novalidate>
                                                    <div class="modal-content">

                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="editTimeBasedModal-@item.TimesheetId">Please input below Volunteering Hours</h5>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                        </div>
                                                        <div class="modal-body">

                                                            <div class="container">
                                                                <div class="row mb-3">
                                                                    <div class="col">
                                                                        <label class="mb-2" for="mymission-@item.TimesheetId">Mission</label>

                                                                        <input type="text" class="form-control" id="mymission-@item.TimesheetId"
                                                                           placeholder="Select mission" value="@item.Mission.Title" disabled required>
                                                                        <div class="invalid-feedback">
                                                                            Please select a valid option.
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-3">
                                                                    <div class="col">
                                                                        <label class="mb-2" for="myDate-@item.TimesheetId" class="form-label">Date Volunteered</label>
                                                                        <input type="date" class="form-control" id="myDate-@item.TimesheetId"
                                                                               placeholder="Select date" value="@item.DateVolunteered.ToString("yyyy-MM-dd")" data-start-date="@item.Mission.StartDate" data-end-date="@item.Mission.EndDate" required>
                                                                        <div class="invalid-feedback">
                                                                            Please select a valid date.
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-3">
                                                                    <div class="col-md-6">
                                                                        <label class="mb-2" for="myHour-@item.TimesheetId" class="form-label">Hours</label>
                                                                        <input type="number" class="form-control" min="0" max="23" id="myHour-@item.TimesheetId"
                                                                           placeholder="Enter Spent Hours " value="@item.Time.Value.Hour" required>
                                                                        <div class="invalid-feedback">
                                                                            Please select a valid Hours.
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-6">
                                                                        <label class="mb-2" for="myMinutes-@item.TimesheetId" class="form-label">Minutes</label>
                                                                        <input type="number" class="form-control" min="1" max="60" id="myMinutes-@item.TimesheetId"
                                                                           placeholder="Enter Spent Minutes " value="@item.Time.Value.Minute" required>
                                                                        <div class="invalid-feedback">
                                                                            Please select a valid Minutes.
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-3">
                                                                    <div class="col">
                                                                        <label class="mb-2" for="myMessage-@item.TimesheetId" class="form-label">Message</label>
                                                                        <textarea type="date" class="form-control" id="myMessage-@item.TimesheetId"
                                                                              placeholder="Enter your message" rows="4" required>@item.Notes</textarea>
                                                                        <div class="invalid-feedback">
                                                                            Please write message here.
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" class="btn cancelBtn " data-bs-dismiss="modal">Cancel</button>
                                                            <button type="button" data-user-id="@ViewBag.UserDetails.UserId" data-timesheet-id="@item.TimesheetId" id="SaveBtn2" class="btn SaveBtn">Submit</button>
                                                        </div>

                                                    </div>
                                                </form>
                                            </div>

                                        </div>
                                    </tr>
                                }

                            </tbody>
                        </table>
                    </div>


                </div>
            </div>
            <div class="col-md-6">
                <div class="goalbasedmission border">
                    <div class="px-3">
                        <div class="row">
                            <div class="col-md-10 my-3">
                                <h5 class=" d-inline">Volunteering Goals</h5>
                            </div>
                            <div class="col-md-2 my-3">
                                <div class="justify-content-end">
                                    <button class=" bg-white border-0" type="button"
                                            data-bs-toggle="modal" data-bs-target="#GoalBasedModal">
                                        <img src="/images/add.png" alt="">
                                    </button>
                                </div>
                            </div>
                        </div>

                        <table class="table  table-borderless">
                            <thead>
                                <tr>
                                    <th scope="col">Mission</th>
                                    <th scope="col">Date</th>
                                    <th scope="col">Action</th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.timesheetsGoalBased)
                                {
                                    <tr>
                                        <td>@item.Mission.Title</td>
                                        <td>@item.DateVolunteered</td>
                                        <td>@item.Action</td>
                                        <td>
                                            <button class="d-inline border-0 bg-white" type="button" id="editableBtn2" data-bs-toggle="modal" data-timesheet-id="@item.TimesheetId" data-bs-target="#editGoalBasedModal-@item.TimesheetId"><i class="bi bi-pencil-square"></i></button>
                                            <button class="d-inline border-0 bg-white TrashBtn" type="button" id="TrashBtn2" data-timesheet-id="@item.TimesheetId"><i class="bi bi-trash"></i></button>
                                        </td>
                                        <div class="modal fade" id="editGoalBasedModal-@item.TimesheetId" tabindex="-1" aria-labelledby="exampleModalLabel"
                                     aria-hidden="true">
                                        <div class="modal-dialog modal-lg">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">Please input below Volunteering Goal</h5>
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                </div>
                                                <div class="modal-body">
                                                        <form class="row g-3 needs-validation editableGoalbasedTimesheetValidation" novalidate>
                                                        <div class="container">
                                                            <div class="row mb-3">
                                                                <div class="col">
                                                                  
                                                                    <label class="mb-2" for="mymission2-@item.TimesheetId">Mission</label>
                                                                    <input type="text" class="form-control" id="mymission2-@item.TimesheetId"
                                                                       placeholder="Select mission" value="@item.Mission.Title" disabled required>
                                                                    <div class="invalid-feedback">
                                                                        Please select a valid option.
                                                                    </div>
                                                                    
                                                                </div>
                                                            </div>
                                                            <div class="row mb-3">
                                                                <div class="col">
                                                                    <label class="mb-2" for="myAction-@item.TimesheetId" class="form-label">Actions</label>
                                                                        <input type="number" class="form-control" id="myAction-@item.TimesheetId"
                                                                               placeholder="Enter Actions" min="1" value="@item.Action" required>
                                                                    <div class="invalid-feedback">
                                                                        Please specify a valid action.
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row mb-3">
                                                                <div class="col">
                                                                    <label class="mb-2" for="myDate2-@item.TimesheetId" class="form-label">
                                                                        Date Volunteered
                                                                    </label>
                                                                    <input type="date" class="form-control" id="myDate2-@item.TimesheetId"
                                                                               placeholder="Select date" value="@item.DateVolunteered.ToString("yyyy-MM-dd")" data-start-date="@item.Mission.StartDate" data-end-date="@item.Mission.EndDate" required>
                                                                    <div class="invalid-feedback">
                                                                        Please select a valid date.
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row mb-3">
                                                                <div class="col">
                                                                    <label class="mb-2" for="myMessage2-@item.TimesheetId" class="form-label">Message</label>
                                                                    <textarea type="date" class="form-control" id="myMessage2-@item.TimesheetId"
                                                                                  placeholder="Enter your message" rows="4" required>@item.Notes</textarea>
                                                                    <div class="invalid-feedback">
                                                                        Please write message here.
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn cancelBtn" data-bs-dismiss="modal">Cancel</button>
                                                    <button type="button" data-timesheet-id="@item.TimesheetId" data-user-id="@ViewBag.UserDetails.UserId" id="SaveBtn4" class="btn SaveBtn">Submit</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    </tr>
                                    
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- timebased modal -->
            <div class="modal fade" id="TimeBasedModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                 aria-hidden="true">

                <div class="modal-dialog modal-lg">
                    <form class="row g-3 needs-validation  timebasedtimesheet " novalidate>
                        <div class="modal-content">

                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Please input below Volunteering Hours</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">

                                <div class="container">
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label class="mb-2" for="mymission">Mission</label>
                                            <select class="form-select" id="mymission"
                                                    aria-label="Default select example" required>
                                                   
                                                <option selected value="" disabled>Select your mission</option>
                                                @foreach (var item in Model.Missions.Where(m => m.MissionType == "TIME" && m.DeletedAt== null ))
                                                {
                                                    <option value="@item.MissionId" data-user-id="@ViewBag.UserDetails.UserId" data-start-date="@item.StartDate" data-end-date="@item.EndDate" >@item.Title</option>
                                                }
                                            </select>
                                            <div class="invalid-feedback">
                                                Please select a valid option.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label class="mb-2" for="myDate" class="form-label">Date Volunteered</label>
                                            <input type="date" class="form-control" id="myDate"
                                                   placeholder="Select date"  max="@DateTime.Now.ToString("yyyy-MM-dd")" data-provide="datepicker" required>
                                            <div class="invalid-feedback">
                                                Please select a valid date.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <label class="mb-2" for="myHour" class="form-label">Hours</label>
                                            <input type="number" class="form-control" id="myHour"
                                                   placeholder="Enter Spent Hours " min="0" max="23" required>
                                            <div class="invalid-feedback">
                                                Please select a valid Hours.
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="mb-2" for="myMinutes" class="form-label">Minutes</label>
                                            <input type="number" class="form-control" id="myMinutes"
                                                   placeholder="Enter Spent Minutes " min="1" max="60" required>
                                            <div class="invalid-feedback">
                                                Please select a valid Minutes.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label class="mb-2" for="myMessage" class="form-label">Message</label>
                                            <textarea type="date" class="form-control" id="myMessage"
                                                      placeholder="Enter your message" rows="4" required></textarea>
                                            <div class="invalid-feedback">
                                                Please write message here.
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn cancelBtn " data-bs-dismiss="modal">Cancel</button>
                                <button type="button" data-user-id="@ViewBag.UserDetails.UserId" id="SaveBtn" class="btn SaveBtn">Submit</button>
                            </div>

                        </div>
                    </form>
                </div>

            </div>

            <!-- goalbased modal -->
            <div class="modal fade" id="GoalBasedModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Please input below Volunteering Goal</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form class="row g-3 needs-validation goalbasedtimesheet" novalidate>
                                <div class="container">
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label class="mb-2" for="mymission2">Mission</label>
                                            <select class="form-select" id="mymission2"
                                                    aria-label="Default select example" required>
                                                <option selected value="" disabled>Select your mission</option>
                                                @foreach (var item in Model.Missions.Where(m => m.MissionType == "GOAL"))
                                                {
                                                    <option value="@item.MissionId" data-user-id="@ViewBag.UserDetails.UserId" data-start-date="@item.StartDate" data-end-date="@item.EndDate">@item.Title</option>
                                                }

                                            </select>
                                            <div class="invalid-feedback">
                                                Please select a valid option.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label class="mb-2" for="myAction" class="form-label">Actions</label>
                                            <input type="number" class="form-control" id="myAction"
                                                   placeholder="Enter Actions" min="1" required>
                                            <div class="invalid-feedback">
                                                Please specify a valid action.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label class="mb-2" for="myDate2" class="form-label">
                                                Date Volunteered
                                            </label>
                                            <input type="date" class="form-control" id="myDate2"
                                                   placeholder="Select date"  max="@DateTime.Now.ToString("yyyy-MM-dd")" data-provide="datepicker" required>
                                            <div class="invalid-feedback">
                                                Please select a valid date.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label class="mb-2" for="myMessage2" class="form-label">Message</label>
                                            <textarea type="date" class="form-control" id="myMessage2"
                                                      placeholder="Enter your message" rows="4" required></textarea>
                                            <div class="invalid-feedback">
                                                Please write message here.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn cancelBtn" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" data-user-id="@ViewBag.UserDetails.UserId" id="SaveBtn3" class="btn SaveBtn">Submit</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="fixed-bottom">
        <hr class="hr" />
        <div class="container">
            <div class="d-flex bd-highlight mb-3">
                <a asp-action="PrivacyPolicyPage" asp-controller="UserEditProfile" class="text-decoration-none text-dark p-2"> Privacy Policy</a>
                <div class="p-2 bd-highlight">Cookie Policy</div>
                <div class="p-2 bd-highlight">Terms of Use</div>
                <div class="ms-auto p-2 bd-highlight"> 2019 Optimy.com. All rights reserved</div>
            </div>
        </div>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

   

    <script src="~/js/timesheet.js" asp-append-version="true"></script>
</body>

</html>